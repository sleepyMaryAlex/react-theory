# ?useEffect

–ò—Å–ø–æ–ª—å–∑—É—è —ç—Ç–æ—Ç —Ö—É–∫, –≤—ã –≥–æ–≤–æ—Ä–∏—Ç–µ React —Å–¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –ø–æ—Å–ª–µ —Ä–µ–Ω–¥–µ—Ä–∞.

–° –ø–æ–º–æ—â—å—é —Ö—É–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∞ `useEffect` –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã (–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ DOM –≤—Ä—É—á–Ω—É—é) –∏–∑ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞. –û–Ω –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç—É –∂–µ —Ä–æ–ª—å, —á—Ç–æ –∏ `componentDidMount`, `componentDidUpdate` –∏ `componentWillUnmount` –≤ React-–∫–ª–∞—Å—Å–∞—Ö, –æ–±—ä–µ–¥–∏–Ω–∏–≤ –∏—Ö –≤ –µ–¥–∏–Ω—ã–π API.

–ò–Ω–æ–≥–¥–∞ –º—ã —Ö–æ—Ç–∏–º –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–¥ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ React –æ–±–Ω–æ–≤–∏–ª DOM. –°–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –∏–∑–º–µ–Ω–µ–Ω–∏—è DOM –≤—Ä—É—á–Ω—É—é, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –≤—Å—ë —ç—Ç–æ –ø—Ä–∏–º–µ—Ä—ã —ç—Ñ—Ñ–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Ç—Ä–µ–±—É—é—Ç —Å–±—Ä–æ—Å–∞.

~~~
function Example() {
  const [count, setCount] = useState(0);

  // –ü–æ –ø—Ä–∏–Ω—Ü–∏–ø—É componentDidMount –∏ componentDidUpdate:
  useEffect(() => {
    // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É—è API –±—Ä–∞—É–∑–µ—Ä–∞
    document.title = `–í—ã –Ω–∞–∂–∞–ª–∏ ${count} —Ä–∞–∑`;
  });

  return (
    <div>
      <p>–í—ã –Ω–∞–∂–∞–ª–∏ {count} —Ä–∞–∑</p>
      <button onClick={() => setCount(count + 1)}>
        –ù–∞–∂–º–∏ –Ω–∞ –º–µ–Ω—è
      </button>
    </div>
  );
}
~~~

–ü–æ—Å–∫–æ–ª—å–∫—É —ç—Ñ—Ñ–µ–∫—Ç—ã –æ–±—ä—è–≤–ª—è—é—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, —É –Ω–∏—Ö –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –µ–≥–æ –ø—Ä–æ–ø—Å–∞–º –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—é.

–≠—Ç–æ—Ç –∂–µ –ø—Ä–∏–º–µ—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–ª–∞—Å—Å–æ–≤:

~~~
class Example extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      count: 0
    };
  }

  componentDidMount() {
    document.title = `–í—ã –Ω–∞–∂–∞–ª–∏ ${this.state.count} —Ä–∞–∑`;
  }

  componentDidUpdate() {
    document.title = `–í—ã –Ω–∞–∂–∞–ª–∏ ${this.state.count} —Ä–∞–∑`;
  }

  render() {
    return (
      <div>
        <p>–í—ã –Ω–∞–∂–∞–ª–∏ {this.state.count} —Ä–∞–∑</p>
        <button onClick={() => this.setState({ count: this.state.count + 1 })}>
          –ù–∞–∂–º–∏ –Ω–∞ –º–µ–Ω—è
        </button>
      </div>
    );
  }
}
~~~

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –Ω–∞–º –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à –∫–æ–¥ –º–µ–∂–¥—É –∫–ª–∞—Å—Å–æ–≤—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞.

–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—ã –º–æ–∂–µ—Ç–µ –≤–µ—Ä–Ω—É—Ç—å –∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —É–∫–∞–∑—ã–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç—É, –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞ —Å–æ–±–æ–π ¬´—Å–±—Ä–æ—Å¬ª. –ò–Ω–æ–≥–¥–∞ –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–±—Ä–æ—Å, —á—Ç–æ–±—ã –Ω–µ —Å–ª—É—á–∏–ª–æ—Å—å —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏!

~~~
useEffect(() => {
  ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);
  return () => {
    ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);
  };
});
~~~

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ, React –±—É–¥–µ—Ç –æ—Ç–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –æ—Ç –Ω–∞—à–µ–≥–æ `ChatAPI` –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –∏ –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º —Ä–µ–Ω–¥–µ—Ä–µ. –í React-–∫–ª–∞—Å—Å–µ, –≤—ã, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –æ—Ñ–æ—Ä–º–∏–ª–∏ –±—ã –ø–æ–¥–ø–∏—Å–∫—É –≤ `componentDidMount` –∏ –æ—Ç–º–µ–Ω–∏–ª–∏ –±—ã –µ—ë –≤ `componentWillUnmount`. –ó–¥–µ—Å—å —Å–±—Ä–æ—Å —ç—Ñ—Ñ–µ–∫—Ç–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞.

–≠—Ç–∞ –ª–æ–≥–∏–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω—è–µ–º—ã—Ö –Ω–∞–º–∏ –¥–µ–π—Å—Ç–≤–∏–π –∏ –∏—Å–∫–ª—é—á–∞–µ—Ç –±–∞–≥–∏, —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–µ –≤ –∫–ª–∞—Å—Å–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö –∏–∑-–∑–∞ —É–ø—É—â–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.

~~~
// –ú–æ–Ω—Ç–∏—Ä—É–µ–º —Å –ø—Ä–æ–ø—Å–∞–º–∏ { friend: { id: 100 } }
ChatAPI.subscribeToFriendStatus(100, handleStatusChange);    // –í—ã–ø–æ–ª–Ω—è–µ–º –ø–µ—Ä–≤—ã–π —ç—Ñ—Ñ–µ–∫—Ç
// –û–±–Ω–æ–≤–ª—è–µ–º —Å –ø—Ä–æ–ø—Å–∞–º–∏ { friend: { id: 200 } }
ChatAPI.unsubscribeFromFriendStatus(100, handleStatusChange); // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç
ChatAPI.subscribeToFriendStatus(200, handleStatusChange);    // –í—ã–ø–æ–ª–Ω—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç
// –û–±–Ω–æ–≤–ª—è–µ–º —Å –ø—Ä–æ–ø—Å–∞–º–∏ { friend: { id: 300 } }
ChatAPI.unsubscribeFromFriendStatus(200, handleStatusChange); // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç
ChatAPI.subscribeToFriendStatus(300, handleStatusChange);    // –í—ã–ø–æ–ª–Ω—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç
// –†–∞–∑–º–æ–Ω—Ç–∏—Ä—É–µ–º
ChatAPI.unsubscribeFromFriendStatus(300, handleStatusChange); // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç—Ñ—Ñ–µ–∫—Ç
~~~

–ü–æ—á–µ–º—É –∂–µ –º—ã –≤—ã–∑—ã–≤–∞–µ–º `useEffect` –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞? –≠—Ç–æ –¥–∞—ë—Ç –Ω–∞–º –¥–æ—Å—Ç—É–ø –∫ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å–æ—Å—Ç–æ—è–Ω–∏—è `count` (–∏–ª–∏ –ª—é–±—ã–º –¥—Ä—É–≥–∏–º –ø—Ä–æ–ø—Å–∞–º) –ø—Ä—è–º–∏–∫–æ–º –∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∞. –ù–∞–º –Ω–µ –Ω—É–∂–µ–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π ‚Äî –æ–Ω–∞ —É–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —É –Ω–∞—Å –≤ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏.

–§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –º—ã –ø–µ—Ä–µ–¥–∞—ë–º –≤ `useEffect`, –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ. –ö–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º —Ä–µ–Ω–¥–µ—Ä–µ, –º—ã —Å—Ç–∞–≤–∏–º –≤ –æ—á–µ—Ä–µ–¥—å –Ω–æ–≤—ã–π —ç—Ñ—Ñ–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–º–µ–Ω—è–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–π, —Ç–æ –µ—Å—Ç—å –∫–∞–∂–¥—ã–π —ç—Ñ—Ñ–µ–∫—Ç ¬´–ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç¬ª –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º—É —Ä–µ–Ω–¥–µ—Ä—É.

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, React –∑–∞–ø—É—Å–∫–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç—ã –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞, –≤–∫–ª—é—á–∞—è –ø–µ—Ä–≤—ã–π —Ä–µ–Ω–¥–µ—Ä. React –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –æ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç —ç—Ñ—Ñ–µ–∫—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ DOM —É–∂–µ –æ–±–Ω–æ–≤–∏–ª—Å—è.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ `useEffect`:

* –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç `componentDidMount` –∏–ª–∏ `componentDidUpdate`, —ç—Ñ—Ñ–µ–∫—Ç—ã, –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é `useEffect`, –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –±—Ä–∞—É–∑–µ—Ä –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ–±–Ω–æ–≤–∏—Ç—å —ç–∫—Ä–∞–Ω.
* –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Ö—É–∫–æ–≤, –∫–ª–∞—Å—Å–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —á–∞—Å—Ç–æ —Å–æ–¥–µ—Ä–∂–∞—Ç –ª–æ–≥–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è –Ω–∏–∫–∞–∫ –º–µ–∂–¥—É —Å–æ–±–æ–π –Ω–µ —Å–≤—è–∑–∞–Ω–∞, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ —Å–≤—è–∑–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞, —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤. –≠—Ç–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ –º—ã –Ω–µ –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–∞, –∞ `useEffect` –º–æ–∂–µ–º. –° –ø–æ–º–æ—â—å—é —Ö—É–∫–æ–≤, –º—ã –º–æ–∂–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞—à –∫–æ–¥ –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ —Ç–æ–º, —á—Ç–æ –æ–Ω –¥–µ–ª–∞–µ—Ç, –∞ –Ω–µ –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –º–µ—Ç–æ–¥–æ–≤ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞.

### –°–æ–≤–µ—Ç—ã:

* –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ —Ö—É–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á.
* –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞ —Å—á—ë—Ç –ø—Ä–æ–ø—É—Å–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤.

–í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö —Å–±—Ä–æ—Å –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é. –í –∫–ª–∞—Å—Å–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö, –º—ã –º–æ–∂–µ–º —Ä–µ—à–∏—Ç—å —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ `prevProps` –∏–ª–∏ `prevState` –≤–Ω—É—Ç—Ä–∏ `componentDidUpdate`:

~~~
componentDidUpdate(prevProps, prevState) {
  if (prevState.count !== this.state.count) {
    document.title = `–í—ã –Ω–∞–∂–∞–ª–∏ ${this.state.count} —Ä–∞–∑`;
  }
}
~~~

–ß—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ —Å —Ö—É–∫–æ–º, –ø–µ—Ä–µ–¥–∞–π—Ç–µ –º–∞—Å—Å–∏–≤ –≤ `useEffect` –≤—Ç–æ—Ä—ã–º –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º.

~~~
useEffect(() => {
  document.title = `–í—ã –Ω–∞–∂–∞–ª–∏ ${count} —Ä–∞–∑`;
}, [count]); // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ count –ø–æ–º–µ–Ω—è–ª—Å—è
~~~

–ó–¥–µ—Å—å `useEffect` —Å—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `count` –ø–æ–º–µ–Ω—è–ª—Å—è –∏ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏. –ï—Å–ª–∏ –ø–æ–º–µ–Ω—è—é—Ç—Å—è –¥—Ä—É–≥–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –¥–∞–Ω–Ω—ã–π —Ö—É–∫ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç.

–¢–∞–∫–∂–µ —ç—Ñ—Ñ–µ–∫—Ç –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –µ—Å–ª–∏ –ø—Ä–∏—Å–≤–æ–∏—Ç—å `count` —Ç–æ –∂–µ —Å–∞–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–∞–∫ –∫–∞–∫ React –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º —Å—Ä–∞–≤–Ω–µ–Ω–∏—è `Object.is`.

–ï—Å–ª–∏ —É –≤–∞—Å –±—É–¥–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ, React –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–∞—à —ç—Ñ—Ñ–µ–∫—Ç, –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –∫–æ–≥–¥–∞ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–∑ –Ω–∏—Ö –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è. –í –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ç–æ—Ä–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ (–º–∞—Å—Å–∏–≤–∞) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ–ø—Å—ã –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è. –≠—Ç–æ —Ç–∞–∫–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ —Å —ç—Ç–∞–ø–æ–º —Å–±—Ä–æ—Å–∞.

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç –∏ —Å–±—Ä–æ—Å–∏—Ç—å –µ–≥–æ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ (–ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏), –≤—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç—å –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ (`[]`) –≤—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º. React –ø–æ—Å—á–∏—Ç–∞–µ—Ç, —á—Ç–æ –≤–∞—à —ç—Ñ—Ñ–µ–∫—Ç –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞–∫–∏—Ö-–ª–∏–±–æ –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ –ø—Ä–æ–ø—Å–æ–≤ –∏–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –ø–æ—ç—Ç–æ–º—É –Ω–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤ —ç—Ñ—Ñ–µ–∫—Ç–∞. –ï—Å–ª–∏ –≤—ã –ø–µ—Ä–µ–¥–∞–¥–∏—Ç–µ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ (`[]`), –ø—Ä–æ–ø—Å—ã –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞ –≤—Å–µ–≥–¥–∞ –±—É–¥—É—Ç –∏–º–µ—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è, –ø—Ä–∏—Å–≤–æ–µ–Ω–Ω—ã–µ –∏–º –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ.

### –ß–µ–º —ç—Ñ—Ñ–µ–∫—Ç—ã –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç —Å–æ–±—ã—Ç–∏–π?

–≠—Ñ—Ñ–µ–∫—Ç—ã –ø–æ–∑–≤–æ–ª—è—é—Ç —É–∫–∞–∑–∞—Ç—å –ø–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã, –≤—ã–∑–≤–∞–Ω–Ω—ã–µ —Å–∞–º–∏–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º, –∞ –Ω–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —Å–æ–±—ã—Ç–∏–µ–º. –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç —è–≤–ª—è–µ—Ç—Å—è —Å–æ–±—ã—Ç–∏–µ–º , –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–æ –Ω–∞–ø—Ä—è–º—É—é –≤—ã–∑–≤–∞–Ω–æ –Ω–∞–∂–∞—Ç–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –∫–Ω–æ–ø–∫–∏. –û–¥–Ω–∞–∫–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º —è–≤–ª—è–µ—Ç—Å—è –≠—Ñ—Ñ–µ–∫—Ç–æ–º , –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –≤—ã–∑–≤–∞–ª–æ –ø–æ—è–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.

–≠—Ñ—Ñ–µ–∫—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ —Ñ–∞–∑—ã `commit` –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞. –≠—Ç–æ —Ö–æ—Ä–æ—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ React —Å –∫–∞–∫–æ–π-–ª–∏–±–æ –≤–Ω–µ—à–Ω–µ–π —Å–∏—Å—Ç–µ–º–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–µ—Ç—å—é –∏–ª–∏ —Å—Ç–æ—Ä–æ–Ω–Ω–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π).

### –ü—Ä–∏–º–µ—Ä —Å `video`

~~~
import { useState, useRef, useEffect } from "react";

function VideoPlayer({ src, isPlaying }: { src: string; isPlaying: boolean }) {
  const ref = useRef<HTMLVideoElement>(null);

  useEffect(() => {
    if (isPlaying) {
      console.log("Calling video.play()");
      ref.current!.play();
    } else {
      console.log("Calling video.pause()");
      ref.current!.pause();
    }
  }, [isPlaying]);

  return <video ref={ref} src={src} loop playsInline />;
}

export default function App() {
  const [isPlaying, setIsPlaying] = useState(false);
  const [text, setText] = useState("");
  return (
    <>
      <input value={text} onChange={(e) => setText(e.target.value)} />
      <button onClick={() => setIsPlaying(!isPlaying)}>
        {isPlaying ? "Pause" : "Play"}
      </button>
      <VideoPlayer
        isPlaying={isPlaying}
        src="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4"
      />
    </>
  );
}
~~~

–£ –≤–∞—Å –º–æ–≥ –±—ã –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å —Å–æ–±–ª–∞–∑–Ω –≤—ã–∑–≤–∞—Ç—å `play()` –∏–ª–∏ `pause()` –≤–æ –≤—Ä–µ–º—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞, –Ω–æ —ç—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –í React —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å—Ç—ã–º –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ–º JSX –∏ –Ω–µ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–µ DOM. –ò –±—ã–ª–∞ –±—ã –æ—à–∏–±–∫–∞ `Cannot read properties of null (reading 'pause')`.

–û–±–æ—Ä–∞—á–∏–≤–∞—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ DOM –≤ —ç—Ñ—Ñ–µ–∫—Ç, –≤—ã –ø–æ–∑–≤–æ–ª—è–µ—Ç–µ React —Å–Ω–∞—á–∞–ª–∞ –æ–±–Ω–æ–≤–∏—Ç—å —ç–∫—Ä–∞–Ω. –ó–∞—Ç–µ–º –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤–∞—à –≠—Ñ—Ñ–µ–∫—Ç.

–£–∫–∞–∑–∞–Ω–∏–µ `[isPlaying]` –≤ –∫–∞—á–µ—Å—Ç–≤–µ –º–∞—Å—Å–∏–≤–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Å–æ–æ–±—â–∞–µ—Ç React, —á—Ç–æ –æ–Ω –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤–∞—à–µ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞, –µ—Å–ª–∏ `isPlaying` —Ç–∞–∫–æ–π –∂–µ, –∫–∞–∫ –∏ –≤–æ –≤—Ä–µ–º—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞.

–ú–∞—Å—Å–∏–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π. React –ø—Ä–æ–ø—É—Å—Ç–∏—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ –≠—Ñ—Ñ–µ–∫—Ç–∞ —Ç–æ–ª—å–∫–æ –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –≤—Å–µ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤–∞–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–º–µ—é—Ç —Ç–æ—á–Ω–æ —Ç–∞–∫–∏–µ –∂–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–∞–∫ –∏ –≤–æ –≤—Ä–µ–º—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞. React —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –∏—Å–ø–æ–ª—å–∑—É—è —Ñ—É–Ω–∫—Ü–∏—é —Å—Ä–∞–≤–Ω–µ–Ω–∏—è `Object.is`.

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ ¬´–≤—ã–±—Ä–∞—Ç—å¬ª —Å–≤–æ–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –í—ã –ø–æ–ª—É—á–∏—Ç–µ –æ—à–∏–±–∫—É `lint`, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤–∞–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º React –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–¥–∞ –≤–Ω—É—Ç—Ä–∏ –≤–∞—à–µ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –≤ –≤–∞—à–µ–º –∫–æ–¥–µ.

### –õ–æ–≤—É—à–∫–∞

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç—Ñ—Ñ–µ–∫—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞. –í–æ—Ç –ø–æ—á–µ–º—É —Ç–∞–∫–æ–π –∫–æ–¥ —Å–æ–∑–¥–∞—Å—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª:

~~~
const [count, setCount] = useState(0);
useEffect(() => {
  setCount(count + 1);
});
~~~

–≠—Ñ—Ñ–µ–∫—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥.

### –ö–∞–∫ —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –¥–≤–æ–π–Ω—ã–º —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ–º –≠—Ñ—Ñ–µ–∫—Ç–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ?

React –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –ø–µ—Ä–µ–º–æ–Ω—Ç–∏—Ä—É–µ—Ç –≤–∞—à–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –æ—à–∏–±–∫–∏, –∫–∞–∫ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º –ø—Ä–∏–º–µ—Ä–µ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å –Ω–µ ¬´–∫–∞–∫ –æ–¥–∏–Ω —Ä–∞–∑ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≠—Ñ—Ñ–µ–∫—Ç¬ª, –∞ ¬´–∫–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –º–æ–π –≠—Ñ—Ñ–µ–∫—Ç, —á—Ç–æ–±—ã –æ–Ω —Ä–∞–±–æ—Ç–∞–ª –ø–æ—Å–ª–µ –ø–µ—Ä–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è¬ª.

–û–±—ã—á–Ω–æ –æ—Ç–≤–µ—Ç –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—á–∏—Å—Ç–∫–∏. –§—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ –¥–æ–ª–∂–Ω–∞ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–ª–∏ –æ—Ç–º–µ–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ –≠—Ñ—Ñ–µ–∫—Ç–∞.

–ò–Ω–æ–≥–¥–∞ –≤–∞–º –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤–∏–¥–∂–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –Ω–∞–ø–∏—Å–∞–Ω—ã –¥–ª—è React. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–ø—É—Å—Ç–∏–º, –≤—ã –¥–æ–±–∞–≤–ª—è–µ—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç—ã –Ω–∞ —Å–≤–æ—é —Å—Ç—Ä–∞–Ω–∏—Ü—É.

~~~
useEffect(() => {
  const map = mapRef.current;
  map.setZoomLevel(zoomLevel);
}, [zoomLevel]);
~~~

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ –æ—á–∏—Å—Ç–∫–µ. –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ React –¥–≤–∞–∂–¥—ã –≤—ã–∑–æ–≤–µ—Ç Effect, –Ω–æ —ç—Ç–æ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤—ã–∑–æ–≤ `setZoomLevel` –¥–≤–∞–∂–¥—ã —Å –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ –∑–Ω–∞—á–µ–Ω–∏–µ–º –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç.

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ API –º–æ–≥—É—Ç –Ω–µ –ø–æ–∑–≤–æ–ª—è—Ç—å –≤—ã–∑—ã–≤–∞—Ç—å –∏—Ö –¥–≤–∞–∂–¥—ã –ø–æ–¥—Ä—è–¥. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–µ—Ç–æ–¥ `showModal` –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ `<dialog>` –≤—ã–∑—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –≤—ã –≤—ã–∑—ã–≤–∞–µ—Ç–µ –µ–≥–æ –¥–≤–∞–∂–¥—ã. –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –æ—á–∏—Å—Ç–∫–∏ –∏ –∑–∞–∫—Ä–æ–π—Ç–µ –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ:

~~~
—á–∏—Å—Ç–∫–∏ –∏ –∑–∞–∫—Ä–æ–π—Ç–µ –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ:

useEffect(() => {
  const dialog = dialogRef.current;
  dialog.showModal();
  return () => dialog.close();
}, []);
~~~

–í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤–∞—à –≠—Ñ—Ñ–µ–∫—Ç –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å `showModal()`, –∑–∞—Ç–µ–º –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ `close()`, –∞ –∑–∞—Ç–µ–º —Å–Ω–æ–≤–∞ `showModal()`. –≠—Ç–æ –∏–º–µ–µ—Ç —Ç–∞–∫–æ–µ –∂–µ –≤–∏–¥–∏–º–æ–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –∫–∞–∫ –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω—ã–π –≤—ã–∑–æ–≤ `showModal()`, –∫–∞–∫ –≤—ã –º–æ–≥–ª–∏ –±—ã –≤–∏–¥–µ—Ç—å –≤ `production`.

–ï—Å–ª–∏ –≤–∞—à –≠—Ñ—Ñ–µ–∫—Ç –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —á—Ç–æ-—Ç–æ, —Ñ—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ –¥–æ–ª–∂–Ω–∞ –æ—Ç–ø–∏—Å–∞—Ç—å—Å—è:

~~~
useEffect(() => {
  function handleScroll(e) {
    console.log(window.scrollX, window.scrollY);
  }
  window.addEventListener('scroll', handleScroll);
  return () => window.removeEventListener('scroll', handleScroll);
}, []);
~~~

–ï—Å–ª–∏ –≤–∞—à –≠—Ñ—Ñ–µ–∫—Ç —á—Ç–æ-—Ç–æ –∞–Ω–∏–º–∏—Ä—É–µ—Ç, —Ñ—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ –¥–æ–ª–∂–Ω–∞ —Å–±—Ä–æ—Å–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é –¥–æ –∏—Å—Ö–æ–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:

~~~
useEffect(() => {
  const node = ref.current;
  node.style.opacity = 1; // Trigger the animation
  return () => {
    node.style.opacity = 0; // Reset to the initial value
  };
}, []);
~~~

–ï—Å–ª–∏ –≤–∞—à –≠—Ñ—Ñ–µ–∫—Ç –∏–∑–≤–ª–µ–∫–∞–µ—Ç —á—Ç–æ-—Ç–æ, —Ñ—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ –¥–æ–ª–∂–Ω–∞ –ª–∏–±–æ –ø—Ä–µ—Ä–≤–∞—Ç—å —Ñ–µ—Ç—á–∏–Ω–≥ –ª–∏–±–æ –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –µ–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

~~~
useEffect(() => {
  let ignore = false;

  async function startFetching() {
    const json = await fetchTodos(userId);
    if (!ignore) {
      setTodos(json);
    }
  }

  startFetching();

  return () => {
    ignore = true;
  };
}, [userId]);
~~~

–í—ã –Ω–µ –º–æ–∂–µ—Ç–µ ¬´–æ—Ç–º–µ–Ω–∏—Ç—å¬ª —Å–µ—Ç–µ–≤–æ–π –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω, –Ω–æ –≤–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ –¥–æ–ª–∂–Ω–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ —Ñ–µ—Ç—á–∏–Ω–≥, –∫–æ—Ç–æ—Ä—ã–π –±–æ–ª—å—à–µ –Ω–µ –∞–∫—Ç—É–∞–ª–µ–Ω, –Ω–µ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –ï—Å–ª–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑–º–µ–Ω–∏—Ç—Å—è —Å ¬´–ê–ª–∏—Å–∞¬ª –Ω–∞ ¬´–ë–æ–±¬ª, –æ—á–∏—Å—Ç–∫–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –æ—Ç–≤–µ—Ç ¬´–ê–ª–∏—Å–∞¬ª –±—É–¥–µ—Ç –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω –ø—Ä–∏–¥–µ—Ç –ø–æ—Å–ª–µ ¬´–ë–æ–±–∞¬ª.

### –ù–µ —ç—Ñ—Ñ–µ–∫—Ç: –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ù–µ–∫–æ—Ç–æ—Ä–∞—è –ª–æ–≥–∏–∫–∞ –¥–æ–ª–∂–Ω–∞ –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –í—ã –º–æ–∂–µ—Ç–µ –ø–æ–º–µ—Å—Ç–∏—Ç—å –µ–≥–æ –≤–Ω–µ —Å–≤–æ–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

~~~
if (typeof window !== 'undefined') { // Check if we're running in the browser.
  checkAuthToken();
  loadDataFromLocalStorage();
}

function App() {
  // ...
}
~~~

–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ç–∞–∫–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –±—Ä–∞—É–∑–µ—Ä–æ–º.

### –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –≤–º–µ—Å—Ç–µ

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `setTimeout`, —á—Ç–æ–±—ã –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –∫–æ–Ω—Å–æ–ª–∏ —Å –≤—Ö–æ–¥–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º —á–µ—Ä–µ–∑ —Ç—Ä–∏ —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∞. –§—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ –æ—Ç–º–µ–Ω—è–µ—Ç –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–π —Ç–∞–π–º-–∞—É—Ç.

~~~
import { useState, useEffect } from "react";

function Playground() {
  const [text, setText] = useState("a");

  useEffect(() => {
    function onTimeout() {
      console.log("‚è∞ " + text);
    }

    console.log('üîµ Schedule "' + text + '" log');
    const timeoutId = setTimeout(onTimeout, 3000);

    return () => {
      console.log('üü° Cancel "' + text + '" log');
      clearTimeout(timeoutId);
    };
  }, [text]);

  return (
    <>
      <label>
        What to log:{" "}
        <input value={text} onChange={(e) => setText(e.target.value)} />
      </label>
      <h1>{text}</h1>
    </>
  );
}

export default function App() {
  const [show, setShow] = useState(false);
  return (
    <>
      <button onClick={() => setShow(!show)}>
        {show ? "Unmount" : "Mount"} the component
      </button>
      {show && <hr />}
      {show && <Playground />}
    </>
  );
}
~~~

–°–Ω–∞—á–∞–ª–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ —Ç—Ä–∏ –∂—É—Ä–Ω–∞–ª–∞: `Schedule "a" log`, `Cancel "a" log` –∏ —Å–Ω–æ–≤–∞ `Schedule "a" log`. –¢—Ä–µ–º—è —Å–µ–∫—É–Ω–¥–∞–º–∏ –ø–æ–∑–∂–µ —Ç–∞–∫–∂–µ –ø–æ—è–≤–∏—Ç—Å—è –ª–æ–≥ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º `a`. –ö–∞–∫ –≤—ã —É–∑–Ω–∞–ª–∏ —Ä–∞–Ω–µ–µ, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–∞—Ä–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è/–æ—Ç–º–µ–Ω—ã —Å–≤—è–∑–∞–Ω–∞ —Å —Ç–µ–º, —á—Ç–æ React –ø–æ–≤—Ç–æ—Ä–Ω–æ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ—Å–ª–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ –æ—á–∏—Å—Ç–∫—É.

–¢–µ–ø–µ—Ä—å –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –≤–≤–æ–¥, –Ω–∞–ø–∏—à–∏—Ç–µ `abc`.

~~~
üîµ Schedule "a" log
üü° Cancel "a" log
üîµ Schedule "a" log
üü° Cancel "a" log
üîµ Schedule "ab" log
üü° Cancel "ab" log
üîµ Schedule "abc" log
‚è∞ abc
~~~

React –≤—Å–µ–≥–¥–∞ –æ—á–∏—â–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞ –ø–µ—Ä–µ–¥ —ç—Ñ—Ñ–µ–∫—Ç–æ–º —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞.

–í–≤–µ–¥–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞, –∞ –∑–∞—Ç–µ–º —Å—Ä–∞–∑—É –∂–µ –Ω–∞–∂–º–∏—Ç–µ `¬´Unmount the component¬ª`. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –∫–∞–∫ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—á–∏—â–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞. –ó–¥–µ—Å—å –æ–Ω –æ—á–∏—â–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ç–∞–π–º-–∞—É—Ç, –ø—Ä–µ–∂–¥–µ —á–µ–º –æ–Ω —Å–º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è.

–ù–∞–∫–æ–Ω–µ—Ü, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ã—à–µ –∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –æ—á–∏—Å—Ç–∫–∏, —á—Ç–æ–±—ã —Ç–∞–π–º-–∞—É—Ç—ã –Ω–µ –æ—Ç–º–µ–Ω—è–ª–∏—Å—å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –±—ã—Å—Ç—Ä–æ –Ω–∞–±–∏—Ä–∞—Ç—å `abcde`.

–ß–µ—Ä–µ–∑ —Ç—Ä–∏ —Å–µ–∫—É–Ω–¥—ã –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ª–æ–≥–æ–≤ (`a`, `ab`, `abc`, `abcd` –∏ `abcde`), –∞ –Ω–µ –ø—è—Ç—å –ª–æ–≥–æ–≤ `abcde`. –ö–∞–∂–¥—ã–π –≠—Ñ—Ñ–µ–∫—Ç ¬´–∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç¬ª —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞. –ù–µ–≤–∞–∂–Ω–æ, —á—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å: –≠—Ñ—Ñ–µ–∫—Ç –æ—Ç —Ä–µ–Ω–¥–µ—Ä–∞ —Å `text = 'ab'` –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –≤–∏–¥–µ—Ç—å `'ab'`. –î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –≠—Ñ—Ñ–µ–∫—Ç—ã –∫–∞–∂–¥–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞.

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≠—Ñ—Ñ–µ–∫—Ç–∞

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≠—Ñ—Ñ–µ–∫—Ç–∞, –≤—ã –º–æ–∂–µ—Ç–µ —Å—Ç–æ–ª–∫–Ω—É—Ç—å—Å—è —Å –ø—Ä–æ–±–ª–µ–º–æ–π:

~~~
function Counter() {
  const [count, setCount] = useState(0);

  useEffect(() => {
    const intervalId = setInterval(() => {
      setCount(count + 1); // You want to increment the counter every second...
    }, 1000)
    return () => clearInterval(intervalId);
  }, [count]); // üö© ... but specifying `count` as a dependency always resets the interval.
  // ...
}
~~~

–ü–æ—Å–∫–æ–ª—å–∫—É `count` —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º, –µ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å –≤ —Å–ø–∏—Å–∫–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π. –û–¥–Ω–∞–∫–æ —ç—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—á–∏—Å—Ç–∫–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –≠—Ñ—Ñ–µ–∫—Ç–∞ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `count`. –≠—Ç–æ –Ω–µ –∏–¥–µ–∞–ª—å–Ω–æ.

–ß—Ç–æ–±—ã –∏—Å–ø—Ä–∞–≤–∏—Ç—å —ç—Ç–æ, –ø–µ—Ä–µ–¥–∞–π—Ç–µ `c => c + 1` –≤ `setCount`.

### –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–ï—Å–ª–∏ –≤–∞—à –≠—Ñ—Ñ–µ–∫—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–±—ä–µ–∫—Ç–∞ –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–∏, —Å–æ–∑–¥–∞–Ω–Ω–æ–π –≤–æ –≤—Ä–µ–º—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞, –æ–Ω –º–æ–∂–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ. –ù–∞–ø—Ä–∏–º–µ—Ä, —ç—Ç–æ—Ç –≠—Ñ—Ñ–µ–∫—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–±—ä–µ–∫—Ç `options` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞ —Ä–∞–∑–Ω—ã–π:

~~~
const serverUrl = 'https://localhost:1234';

function ChatRoom({ roomId }) {
  const [message, setMessage] = useState('');

  const options = { // üö© This object is created from scratch on every re-render
    serverUrl: serverUrl,
    roomId: roomId
  };

  useEffect(() => {
    const connection = createConnection(options); // It's used inside the Effect
    connection.connect();
    return () => connection.disconnect();
  }, [options]); // üö© As a result, these dependencies are always different on a re-render
  // ...
}
~~~

–ò–∑–±–µ–≥–∞–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞, —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –≤–æ –≤—Ä–µ–º—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞, –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–π—Ç–µ –æ–±—ä–µ–∫—Ç –≤–Ω—É—Ç—Ä–∏ –≠—Ñ—Ñ–µ–∫—Ç–∞.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–æ–ø—Å–æ–≤

–ò–Ω–æ–≥–¥–∞ –≤–∞–º –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è —Å–±—Ä–æ—Å–∏—Ç—å –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —á–∞—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–æ–ø—Å–æ–≤, –Ω–æ –Ω–µ –≤—Å–µ.

~~~
function List({ items }) {
  const [isReverse, setIsReverse] = useState(false);
  const [selection, setSelection] = useState(null);

  // üî¥ Avoid: Adjusting state on prop change in an Effect
  useEffect(() => {
    setSelection(null);
  }, [items]);
  // ...
}
~~~

–≠—Ç–æ –Ω–µ –∏–¥–µ–∞–ª—å–Ω–æ. –ö–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑–º–µ–Ω—è—é—Ç—Å—è, —Å–ø–∏—Å–æ–∫ –∏ –µ–≥–æ –¥–æ—á–µ—Ä–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–Ω–∞—á–∞–ª–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –≤—ã–±–æ—Ä–∞. –ó–∞—Ç–µ–º React –æ–±–Ω–æ–≤–∏—Ç DOM –∏ –∑–∞–ø—É—Å—Ç–∏—Ç —ç—Ñ—Ñ–µ–∫—Ç—ã. –ù–∞–∫–æ–Ω–µ—Ü, –≤—ã–∑–æ–≤ `setSelection(null)` –≤—ã–∑–æ–≤–µ—Ç –µ—â–µ –æ–¥–∏–Ω –ø–æ–≤—Ç–æ—Ä–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–ø–∏—Å–∫–∞ –∏ –µ–≥–æ –¥–æ—á–µ—Ä–Ω–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —Å–Ω–æ–≤–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–≤ –≤–µ—Å—å —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å.

–í–º–µ—Å—Ç–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–∏ —Å–±—Ä–æ—Å–∞) –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞:

~~~
function List({ items }) {
  const [isReverse, setIsReverse] = useState(false);
  const [selectedId, setSelectedId] = useState(null);
  // ‚úÖ Best: Calculate everything during rendering
  const selection = items.find(item => item.id === selectedId) ?? null;
  // ...
}
~~~

–û–ø–µ—Ä–∞—Ç–æ—Ä `??` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç, –µ—Å–ª–∏ –æ–Ω –Ω–µ `null`/`undefined`, –∏–Ω–∞—á–µ –≤—Ç–æ—Ä–æ–π.

### –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–æ–¥–∏—Ç–µ–ª—é

–≠—Ç–æ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `Child` –∏–∑–≤–ª–µ–∫–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ, –∞ –∑–∞—Ç–µ–º –ø–µ—Ä–µ–¥–∞–µ—Ç –∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É `Parent` –≤ —ç—Ñ—Ñ–µ–∫—Ç–µ:

~~~
function Parent() {
  const [data, setData] = useState(null);
  // ...
  return <Child onFetched={setData} />;
}

function Child({ onFetched }) {
  const data = useSomeAPI();
  // üî¥ Avoid: Passing data to the parent in an Effect
  useEffect(() => {
    if (data) {
      onFetched(data);
    }
  }, [onFetched, data]);
  // ...
}
~~~

–ö–æ–≥–¥–∞ –¥–æ—á–µ—Ä–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–≤–æ–∏—Ö —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ –≠—Ñ—Ñ–µ–∫—Ç–∞—Ö, –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ—á–µ–Ω—å —Ç—Ä—É–¥–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å. –ü–æ—Å–∫–æ–ª—å–∫—É –∏ –¥–æ—á–µ—Ä–Ω–µ–º—É, –∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º –Ω—É–∂–Ω—ã –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ, –ø–æ–∑–≤–æ–ª—å—Ç–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É –ø–æ–ª—É—á–∏—Ç—å —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∏ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –ø–µ—Ä–µ–¥–∞—Ç—å –∏—Ö –¥–æ—á–µ—Ä–Ω–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É:

~~~
function Parent() {
  const data = useSomeAPI();
  // ...
  // ‚úÖ Good: Passing data down to the child
  return <Child data={data} />;
}

function Child({ data }) {
  // ...
}
~~~

–≠—Ç–æ –ø—Ä–æ—â–µ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö: –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ç–µ–∫–∞—é—Ç –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è –∫ –¥–æ—á–µ—Ä–Ω–µ–º—É.

### –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–ú–Ω–æ–≥–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≠—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ñ–µ—Ç—á–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö. –î–æ–≤–æ–ª—å–Ω–æ —á–∞—Å—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç –≤—ã–±–æ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

~~~
function SearchResults({ query }) {
  const [results, setResults] = useState([]);
  const [page, setPage] = useState(1);

  useEffect(() => {
    // üî¥ Avoid: Fetching without cleanup logic
    fetchResults(query, page).then(json => {
      setResults(json);
    });
  }, [query, page]);

  function handleNextPageClick() {
    setPage(page + 1);
  }
  // ...
}
~~~

–û–¥–Ω–∞–∫–æ –≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –≤—ã—à–µ –∫–æ–¥–µ –µ—Å—Ç—å –æ—à–∏–±–∫–∞. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –±—ã—Å—Ç—Ä–æ –ø–µ—á–∞—Ç–∞–µ—Ç–µ `"hello"`. –ó–∞—Ç–µ–º `query` –∏–∑–º–µ–Ω–∏—Ç—Å—è —Å `"h"`, –Ω–∞ `"he"`, `"hel"`, `"hell"` –∏ `"hello"`. –≠—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–µ—Ç—á–∏–Ω–≥–∏, –Ω–æ –Ω–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏, –≤ –∫–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –±—É–¥—É—Ç –ø–æ—Å—Ç—É–ø–∞—Ç—å –æ—Ç–≤–µ—Ç—ã.

–ß—Ç–æ–±—ã –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ–Ω–∫–∏, –≤–∞–º –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –æ—á–∏—Å—Ç–∫–∏, —á—Ç–æ–±—ã –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –æ—Ç–≤–µ—Ç—ã:

~~~
function SearchResults({ query }) {
  const [results, setResults] = useState([]);
  const [page, setPage] = useState(1);
  useEffect(() => {
    let ignore = false;
    fetchResults(query, page).then(json => {
      if (!ignore) {
        setResults(json);
      }
    });
    return () => {
      ignore = true;
    };
  }, [query, page]);

  function handleNextPageClick() {
    setPage(page + 1);
  }
  // ...
}
~~~

–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∫–æ–≥–¥–∞ –≤–∞—à —ç—Ñ—Ñ–µ–∫—Ç –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –≤—Å–µ –æ—Ç–≤–µ—Ç—ã, –∫—Ä–æ–º–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω–æ–≥–æ, –±—É–¥—É—Ç –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã.

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–µ–ª–∏ –±—ã —Å–¥–µ–ª–∞—Ç—å –≤—ã–±–æ—Ä–∫—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ Effects –±–æ–ª–µ–µ —ç—Ä–≥–æ–Ω–æ–º–∏—á–Ω–æ–π, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ —Ñ–µ—Ç—á–∏–Ω–≥–∞ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ö—É–∫, –∫–∞–∫ –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ:

~~~
function SearchResults({ query }) {
  const [page, setPage] = useState(1);
  const params = new URLSearchParams({ query, page });
  const results = useData(`/api/search?${params}`);

  function handleNextPageClick() {
    setPage(page + 1);
  }
  // ...
}

function useData(url) {
  const [data, setData] = useState(null);
  useEffect(() => {
    let ignore = false;
    fetch(url)
      .then(response => response.json())
      .then(json => {
        if (!ignore) {
          setData(json);
        }
      });
    return () => {
      ignore = true;
    };
  }, [url]);
  return data;
}
~~~
